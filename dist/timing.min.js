!function(t){Timing=t("undefined"!=typeof Parallelio?Parallelio:this.Parallelio),Timing.definition=t,"undefined"!=typeof module&&null!==module?module.exports=Timing:"undefined"!=typeof Parallelio&&null!==Parallelio?Parallelio.Timing=Timing:(null==this.Parallelio&&(this.Parallelio={}),this.Parallelio.Timing=Timing)}(function(t){null==t&&(t={});var i,e=t.hasOwnProperty("BaseUpdater")?t.BaseUpdater:require("spark-starter").Updater;return i=function(){function t(t){this.running=null==t||t,this.children=[]}return t.prototype.addChild=function(t){var i;return i=this.children.indexOf(t),this.updater&&(t.updater.dispatcher=this.updater),-1===i&&this.children.push(t),t.parent=this,this},t.prototype.removeChild=function(t){var i;return i=this.children.indexOf(t),i>-1&&this.children.splice(i,1),t.parent===this&&(t.parent=null),this},t.prototype.toggle=function(t){return void 0===t&&(t=!this.running),this.running=t,this.children.forEach(function(i){return i.toggle(t)})},t.prototype.setTimeout=function(t,i){var e;return e=new this.constructor.Timer(i,t,this.running),this.addChild(e),e},t.prototype.setInterval=function(t,i){var e;return e=new this.constructor.Timer(i,t,this.running,!0),this.addChild(e),e},t.prototype.pause=function(){return this.toggle(!1)},t.prototype.unpause=function(){return this.toggle(!0)},t}(),i.Timer=function(){function t(t,n,r,s){this.time=t,this.running=null==r||r,this.repeat=null!=s&&s,this.remainingTime=this.time,this.updater=new i.Updater(this),this.dispatcher=new e,n&&this.dispatcher.addCallback(n),this.running&&this._start()}return t.now=function(){var t;return null!=("undefined"!=typeof window&&null!==window&&null!=(t=window.performance)?t.now:void 0)?window.performance.now():null!=("undefined"!=typeof process&&null!==process?process.uptime:void 0)?1e3*process.uptime():Date.now()},t.prototype.toggle=function(t){return void 0===t&&(t=!this.running),t?this._start():this._stop()},t.prototype.pause=function(){return this.toggle(!1)},t.prototype.unpause=function(){return this.toggle(!0)},t.prototype.getElapsedTime=function(){return this.running?this.constructor.now()-this.startTime:this.time-this.remainingTime},t.prototype.getPrc=function(){return this.getElapsedTime()/this.time},t.prototype._start=function(){return this.running=!0,this.updater.forwardCallbacks(),this.startTime=this.constructor.now(),this.repeat&&!this.interupted?this.id=setInterval(this.tick.bind(this),this.remainingTime):this.id=setTimeout(this.tick.bind(this),this.remainingTime)},t.prototype._stop=function(){var t;return t=this.interupted,this.running=!1,this.updater.unforwardCallbacks(),this.remainingTime=this.time-(this.constructor.now()-this.startTime),this.interupted=this.remainingTime!==this.time,this.repeat&&!t?clearInterval(this.id):clearTimeout(this.id)},t.prototype.tick=function(){var t;return t=this.interupted,this.interupted=!1,this.repeat?this.remainingTime=this.time:this.remainingTime=0,this.dispatcher.update(),this.repeat?t?this._start():this.startTime=this.constructor.now():this.destroy()},t.prototype.destroy=function(){if(this.repeat?clearInterval(this.id):clearTimeout(this.id),this.updater.destroy(),this.dispatcher.destroy(),this.running=!1,this.parent)return this.parent.removeChild(this)},t}(),i.Updater=function(){function t(t){this.parent=t,this.dispatcher=new e,this.callbacks=[]}return t.prototype.addCallback=function(t){if(this.callbacks.includes(t)||this.callbacks.push(t),this.parent.running&&this.dispatcher)return this.dispatcher.addCallback(t)},t.prototype.removeCallback=function(t){var i;if(i=this.callbacks.indexOf(t),-1!==i&&this.callbacks.splice(i,1),this.dispatcher)return this.dispatcher.removeCallback(t)},t.prototype.getBinder=function(){if(this.dispatcher)return new e.Binder(this)},t.prototype.forwardCallbacks=function(){if(this.dispatcher)return this.callbacks.forEach(function(t){return function(i){return t.dispatcher.addCallback(i)}}(this))},t.prototype.unforwardCallbacks=function(){if(this.dispatcher)return this.callbacks.forEach(function(t){return function(i){return t.dispatcher.removeCallback(i)}}(this))},t.prototype.destroy=function(){return this.unforwardCallbacks(),this.callbacks=[],this.parent=null},t}(),i});